#!/bin/bash

# Takes screenshot of user selected area

usage() {
    echo "$(tput bold)screenshot$(tput sgr0)
    screenshot [-s]

    Takes screenshot. If -s is provided, only a selection
    will be captured.
    "
    exit
}

fn="$HOME/desktop/$(date +%s).png"

case $1 in
  -h|--help) usage ;;
esac

if [[ $1 == "-s" ]]; then
    read -r G < <(slop -f "%g")
    import -window root -crop $G "$fn"
else
    scrot "$fn"
fi

{
res=$(dunstify \
          --action='open,Open' \
          --action='delete,Delete' \
          --action='copy,Copy' "Screenshot" "~$fn"\
          --appname="Screenshot" \
          --raw_icon="$fn"
)

case $res in
    open)
        feh $fn ;;
    delete)
        rm $fn ;;
    copy)
        xclip -selection clipboard -t image/png -i $fn
esac
} &
